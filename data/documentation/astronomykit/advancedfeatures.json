{"metadata":{"modules":[{"name":"AstronomyKit"}],"title":"Advanced Features","role":"article","roleHeading":"Article"},"sections":[],"schemaVersion":{"patch":0,"major":0,"minor":3},"primaryContentSections":[{"content":[{"level":2,"text":"Overview","type":"heading","anchor":"Overview"},{"type":"paragraph","inlineContent":[{"text":"AstronomyKit includes advanced features for specialized astronomical calculations, including gravity simulations, Lagrange point positions, Jupiter’s Galilean moons, planetary rotation axes, and atmospheric modeling.","type":"text"}]},{"level":2,"text":"N-Body Gravity Simulation","type":"heading","anchor":"N-Body-Gravity-Simulation"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Simulate the gravitational motion of objects in the solar system."}]},{"level":3,"text":"Creating a Simulation","type":"heading","anchor":"Creating-a-Simulation"},{"type":"codeListing","code":["\/\/ Initial state for a small body (e.g., a comet)","let initialState = StateVector(...)  \/\/ Position and velocity","","let sim = try GravitySimulation(","    origin: .sun,","    time: .now,","    initialState: initialState",")"],"syntax":"swift"},{"level":3,"text":"Running the Simulation","type":"heading","anchor":"Running-the-Simulation"},{"type":"codeListing","code":["\/\/ Advance 30 days","try sim.update(to: .now.addingDays(30))","","\/\/ Get the current simulation time","let currentTime = sim.currentTime()","","\/\/ Get state of a major body","let jupiterState = try sim.state(of: .jupiter)","print(\"Jupiter position: \\(jupiterState.position)\")"],"syntax":"swift"},{"level":3,"text":"Reversing Time","type":"heading","anchor":"Reversing-Time"},{"type":"codeListing","code":["\/\/ Switch direction (forward ↔ backward)","sim.swap()","","\/\/ Now updates go backward in time","try sim.update(to: .now.addingDays(-30))"],"syntax":"swift"},{"level":2,"text":"Lagrange Points","type":"heading","anchor":"Lagrange-Points"},{"type":"paragraph","inlineContent":[{"text":"Lagrange points are stable\/semi-stable locations in a two-body gravitational system.","type":"text"}]},{"level":3,"text":"Calculate Lagrange Point Position","type":"heading","anchor":"Calculate-Lagrange-Point-Position"},{"type":"codeListing","code":["\/\/ Sun-Earth L2 (where JWST orbits)","let l2 = try LagrangePoint.calculate(","    point: .l2,","    at: .now,","    majorBody: .sun,","    minorBody: .earth",")","print(\"L2 position: \\(l2.position)\")","print(\"L2 velocity: \\(l2.velocity)\")"],"syntax":"swift"},{"level":3,"text":"The Five Lagrange Points","type":"heading","anchor":"The-Five-Lagrange-Points"},{"type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Point"}]}],[{"inlineContent":[{"type":"text","text":"Location"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Stability"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"L1"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Between bodies"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Unstable"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"L2"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Beyond smaller body","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Unstable"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"L3"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Beyond larger body"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Unstable"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"L4"}],"type":"paragraph"}],[{"inlineContent":[{"text":"60° ahead","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Stable","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"L5"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"60° behind"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Stable"}],"type":"paragraph"}]]],"header":"row"},{"text":"Jupiter’s Galilean Moons","anchor":"Jupiters-Galilean-Moons","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Get positions of Io, Europa, Ganymede, and Callisto."}],"type":"paragraph"},{"text":"Moon States","anchor":"Moon-States","type":"heading","level":3},{"syntax":"swift","code":["let moons = try Jupiter.moons(at: .now)","","\/\/ Each moon has position and velocity relative to Jupiter","print(\"Io: \\(moons.io.position)\")","print(\"Europa: \\(moons.europa.position)\")","print(\"Ganymede: \\(moons.ganymede.position)\")","print(\"Callisto: \\(moons.callisto.position)\")"],"type":"codeListing"},{"text":"Checking Moon Position","anchor":"Checking-Moon-Position","type":"heading","level":3},{"syntax":"swift","code":["let moons = try Jupiter.moons(at: .now)","","\/\/ X > 0 means east of Jupiter","if moons.io.position.x > 0 {","    print(\"Io is east of Jupiter\")","} else {","    print(\"Io is west of Jupiter\")","}"],"type":"codeListing"},{"text":"Using as CelestialBodies","anchor":"Using-as-CelestialBodies","type":"heading","level":3},{"inlineContent":[{"text":"The moons are also available as celestial bodies:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["for moon in CelestialBody.galileanMoons {","    let eq = try moon.equatorial(at: .now)","    print(\"\\(moon.name): RA \\(eq.rightAscension)h\")","}"],"type":"codeListing"},{"text":"Planetary Rotation Axes","anchor":"Planetary-Rotation-Axes","type":"heading","level":2},{"inlineContent":[{"text":"Get the orientation of a body’s rotation axis and prime meridian.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["let axis = try CelestialBody.mars.rotationAxis(at: .now)","","\/\/ North pole direction (J2000)","print(\"Pole RA: \\(axis.rightAscension) hours\")","print(\"Pole Dec: \\(axis.declination)°\")","","\/\/ Prime meridian rotation","print(\"Spin angle: \\(axis.spin)°\")","","\/\/ Unit vector toward north pole","let north = axis.north"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"This is useful for:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Calculating solar angles on planetary surfaces"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Determining which hemisphere faces Earth","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Rendering accurate planetary graphics","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"text":"Atmospheric Modeling","anchor":"Atmospheric-Modeling","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Model Earth’s atmosphere based on elevation."}],"type":"paragraph"},{"text":"Atmosphere at Elevation","anchor":"Atmosphere-at-Elevation","type":"heading","level":3},{"syntax":"swift","code":["let atmosphere = try Atmosphere.at(elevation: 5000)  \/\/ 5000m","print(\"Pressure: \\(atmosphere.pressure) mbar\")","print(\"Temperature: \\(atmosphere.temperature)°C\")","print(\"Density: \\(atmosphere.density)\")  \/\/ Relative to sea level"],"type":"codeListing"},{"text":"Observer’s Atmosphere","anchor":"Observers-Atmosphere","type":"heading","level":3},{"syntax":"swift","code":["let observer = Observer(latitude: 39.7, longitude: -104.9, height: 1600)","let atm = try observer.atmosphere","print(\"Local pressure: \\(atm.pressure) mbar\")"],"type":"codeListing"},{"text":"Extreme Altitudes","anchor":"Extreme-Altitudes","type":"heading","level":3},{"syntax":"swift","code":["\/\/ Mount Everest summit","let everest = try Atmosphere.at(elevation: 8848.86)","print(\"Pressure: \\(Int(everest.pressure)) mbar\")  \/\/ ~314 mbar (vs 1013 at sea level)"],"type":"codeListing"},{"text":"Fixed Stars","anchor":"Fixed-Stars","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Define and track fixed stars by their J2000 catalog coordinates."}],"type":"paragraph"},{"text":"Defining a Star","anchor":"Defining-a-Star","type":"heading","level":3},{"syntax":"swift","code":["\/\/ Algol (Beta Persei) - the \"Demon Star\"","let algol = FixedStar(","    name: \"Algol\",","    ra: 3.136148,      \/\/ J2000 RA in hours","    dec: 40.9556,      \/\/ J2000 Dec in degrees","    distance: 92.95    \/\/ Light-years",")","","\/\/ Sirius - the brightest star","let sirius = FixedStar(","    name: \"Sirius\",","    ra: 6.7525,","    dec: -16.7161,","    distance: 8.6",")"],"type":"codeListing"},{"text":"Getting Positions","anchor":"Getting-Positions","type":"heading","level":3},{"syntax":"swift","code":["\/\/ Ecliptic longitude (for astrological calculations)","let longitude = try algol.eclipticLongitude(at: .now)","","\/\/ Position in local sky","let observer = Observer(latitude: 40.7, longitude: -74.0)","let horizon = try algol.horizon(at: .now, from: observer)","","\/\/ Constellation","let constellation = try sirius.constellation(at: .now)"],"type":"codeListing"},{"text":"Finding Catalog Data","anchor":"Finding-Catalog-Data","type":"heading","level":3},{"inlineContent":[{"text":"J2000 coordinates can be found from:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/simbad.cds.unistra.fr\/simbad\/"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Hipparcos Catalog","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yale Bright Star Catalog"}]}]}],"type":"unorderedList"},{"text":"Observer Gravity","anchor":"Observer-Gravity","type":"heading","level":2},{"inlineContent":[{"text":"Calculate local gravitational acceleration:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["let observer = Observer(latitude: 45.0, longitude: 0.0, height: 0)","let gravity = observer.gravity  \/\/ m\/s²","print(\"Local g: \\(gravity) m\/s²\")"],"type":"codeListing"},{"inlineContent":[{"text":"This accounts for:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Latitude (Earth’s oblateness)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Altitude (distance from Earth’s center)"}],"type":"paragraph"}]}],"type":"unorderedList"}],"kind":"content"}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/AdvancedFeatures"},"hierarchy":{"paths":[["doc:\/\/AstronomyKit\/documentation\/AstronomyKit"]]},"seeAlsoSections":[{"title":"Advanced","generated":true,"anchor":"Advanced","identifiers":["doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/GravitySimulation","doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/LagrangePoint","doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/Transit"]}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/astronomykit\/advancedfeatures"]}],"abstract":[{"text":"N-body simulations, Lagrange points, Jupiter’s moons, and more.","type":"text"}],"kind":"article","references":{"doc://AstronomyKit/documentation/AstronomyKit":{"url":"\/documentation\/astronomykit","title":"AstronomyKit","identifier":"doc:\/\/AstronomyKit\/documentation\/AstronomyKit","abstract":[{"type":"text","text":"Swift bindings for Don Cross’ "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/cosinekitty\/astronomy"},{"type":"text","text":" library."}],"type":"topic","kind":"symbol","role":"collection"},"doc://AstronomyKit/documentation/AstronomyKit/LagrangePoint":{"identifier":"doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/LagrangePoint","navigatorTitle":[{"kind":"identifier","text":"LagrangePoint"}],"abstract":[{"type":"text","text":"Lagrange point calculation functions."}],"url":"\/documentation\/astronomykit\/lagrangepoint","kind":"symbol","type":"topic","role":"symbol","title":"LagrangePoint","fragments":[{"kind":"keyword","text":"enum"},{"kind":"text","text":" "},{"kind":"identifier","text":"LagrangePoint"}]},"doc://AstronomyKit/documentation/AstronomyKit/Transit":{"url":"\/documentation\/astronomykit\/transit","kind":"symbol","role":"symbol","identifier":"doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/Transit","abstract":[{"type":"text","text":"Information about a transit of Mercury or Venus across the Sun."}],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Transit","kind":"identifier"}],"type":"topic","title":"Transit","navigatorTitle":[{"text":"Transit","kind":"identifier"}]},"https://github.com/cosinekitty/astronomy":{"url":"https:\/\/github.com\/cosinekitty\/astronomy","type":"link","identifier":"https:\/\/github.com\/cosinekitty\/astronomy","title":"Astronomy Engine","titleInlineContent":[{"type":"text","text":"Astronomy Engine"}]},"https://simbad.cds.unistra.fr/simbad/":{"url":"https:\/\/simbad.cds.unistra.fr\/simbad\/","type":"link","identifier":"https:\/\/simbad.cds.unistra.fr\/simbad\/","title":"SIMBAD Astronomical Database","titleInlineContent":[{"text":"SIMBAD Astronomical Database","type":"text"}]},"doc://AstronomyKit/documentation/AstronomyKit/GravitySimulation":{"fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"GravitySimulation","kind":"identifier"}],"identifier":"doc:\/\/AstronomyKit\/documentation\/AstronomyKit\/GravitySimulation","kind":"symbol","navigatorTitle":[{"text":"GravitySimulation","kind":"identifier"}],"type":"topic","url":"\/documentation\/astronomykit\/gravitysimulation","title":"GravitySimulation","abstract":[{"text":"An n-body gravity simulation for tracking object trajectories.","type":"text"}],"role":"symbol"}}}